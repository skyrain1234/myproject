<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>產品一覽</title>
    <link rel="stylesheet" href="css/all.min.css">
    <link rel="stylesheet" href="css/animate.min.css">
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="slick/slick.css"/>
    <link rel="stylesheet" type="text/css" href="slick/slick-theme.css"/>
    <link rel="stylesheet" href="css/animate.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css">
    <link rel="stylesheet" href="css/myall.css">
    <link rel="icon" href="image/furniture/Modernist_logo4.ico" type="image/png">

    <style>
        a{ 
        text-decoration: none;
        color:black;
        }
    </style>
</head>
<body>
    <!-- 懸浮購物車按鈕和徽章 -->
    <div class="button-container" id="app">
        <a href="cart.html">
            <div class="floating-cart-button">
                <i class="fa-solid fa-cart-shopping"></i>
                <div class="cart-badge" id="cart_quantity">{{itemCount}}</div> <!-- 假設購物車內有 3 件商品 -->
            </div>
        </a>
    </div>
    <!-- ************s01*************** -->
    <section id="s01" class="bg-secondary">
        <div class="container ">
            <div class="row align-items-center">
                <div class="col-4 d-none me-auto" id="s01_manager_only">
                    <a href="admin.html" target="_blank" style="color: var(--mytextcolorWhite2);"><i class="fa-solid fa-gears"></i>控制台</a>
                </div>
                <div class="col-4 text-center mt-2">
                    <div class="h5 text-white">Modernist Lines家具工坊</div>
                </div>
                <div class="col-4 text-end ms-auto">
                    <a href="#">
                        <i class="fa-brands fa-facebook text-white me-3" ></i>
                    </a>
                    <a href="#">
                        <i class="fa-brands fa-x-twitter text-white"></i>
                    </a>     
                </div>
            </div>      
        </div>
    </section>  
    <!-- ************s02*************** -->
    <section id="s02">
        <nav class="navbar navbar-expand-md navbar-light bg-op-black navbar-dark">
            <div class="container">
              <a class="navbar-brand" href="index.html"><img src="image/furniture/Modernist_logo3.png" width="80px" alt=""></a>
              <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
              </button>
              <ul class="navbar-nav me-5">
                <li class="nav-item d-none me-2" id="s02_login_icon">
                    <span class="h3 text-color02"><i class="fa-solid fa-user" id="s02_login_icon_2"></i> <span class="h5" id="login_username_message"></span></span>
                </li>
                <li class="nav-item" id="s02_login_button">
                    <a class="nav-link" data-bs-toggle="modal" data-bs-target="#loginModal" href="#"><i class="fa-solid fa-arrow-right-to-bracket me-2"></i>登入</a>
                </li>
                <li class="nav-item" id="s02_register_button">
                    <a class="nav-link" href="#" data-bs-toggle="modal" data-bs-target="#registeredModal"><i class="fa-solid fa-user-plus me-2"></i>註冊</a>
                </li>
                <li class="nav-item d-none" id="s02_logout_button">
                    <a class="nav-link" href="#" data-bs-toggle="modal"><i class="fa-solid fa-right-from-bracket me-2"></i></i>登出</a>
                </li>
            </ul>
              <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav ms-md-auto  mr-md-auto">
                  <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle active" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false" ><i class="fa-solid fa-circle-info fs-4 me-1"></i>
                    產品介紹
                    </a>
                    <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                        <li><a class="dropdown-item" href="product.html"><i class="fa-solid fa-box me-1"></i>產品一覽</a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item" href="product.html" type="button"><i class="fa-solid fa-couch me-1"></i>沙發/椅子</a></li>
                        <li><a class="dropdown-item" href="product.html" type="button"><i class="fa-solid fa-mug-saucer me-1"></i>辦公桌/椅</a></li>
                        <li><a class="dropdown-item" href="product.html" type="button"><i class="fa-solid fa-shower me-1"></i>衛浴用品</a></li>
                        <li><a class="dropdown-item" href="product.html" type="button"><i class="fa-solid fa-kitchen-set me-1"></i>廚具/餐具</a></li>
                        <li><a class="dropdown-item" href="product.html" type="button"><i class="fa-solid fa-lightbulb me-1"></i>&nbsp;燈具/照明</a></li>
                        <li><a class="dropdown-item" href="product.html" type="button"><i class="fa-solid fa-rug me-1"></i>窗簾/毛毯</a></li>
                      </ul>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link disabled" href="#s06-2"><i class="fa-solid fa-box fs-4"></i>精選推薦</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link disabled" href="#s07-3"><i class="fa-solid fa-ticket fs-4"></i>最新優惠</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link "  href="about.html"><i class="fa-solid fa-book fs-4"></i>關於我們</a>
                  </li>
                  <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false"><i class="fa-solid fa-user-gear fs-4 me-1"></i>
                    會員專區
                    </a>
                    <ul class="dropdown-menu" aria-labelledby="navbarDropdown" id="dropdown-menu_vip">
                      <li><a class="dropdown-item dropdown-item-vip disabled" href="#s07-3"><i class="fa-solid fa-crown me-1"></i>vip優惠</a></li>
                      <li><a class="dropdown-item dropdown-item-vip disabled" href="#"><i class="fa-solid fa-calendar-check me-1"></i>&nbsp;&nbsp;vip權利</a></li>
                      <li><hr class="dropdown-divider"></li>
                      <li><a class="dropdown-item dropdown-item-vip disabled" href="#"><i class="fa-solid fa-angles-right"></i>查看更多</a></li>
                    </ul>
                  </li>
                </ul>
              </div>
            </div>
          </nav>
    </section>
     <!-- loginModal -->
     <div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header text-bg-warning">
                <h5 class="modal-title" id="loginModalLabel">會員登入</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="l_username" class="form-label">帳號</label>
                        <input type="text" class="form-control" id="l_username" name="l_username">
                    </div>
                    <div class="mb-3">
                        <label for="l_password" class="form-label">密碼</label>
                        <!-- 加上form標籤 解決Password field is not contained in a form報錯 -->
                        <!-- 加上autocomplete="off/on" 解決[DOM] Input elements should have autocomplete attributes (suggested: "new-password")報錯 -->
                        <form>
                            <input type="password" class="form-control" id="l_password" name="l_password" autocomplete="on" >
                        </form> 
                    </div>
                </div>
                <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                <button type="button" class="btn btn-primary" id="l_ok_btn">登入</button>
                </div>
            </div>
        </div>
    </div>

    <!-- registeredModal -->
    <div class="modal fade" id="registeredModal" tabindex="-1" aria-labelledby="registeredModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl ">
            <div class="modal-content">
                <div class="modal-header text-bg-success">
                <h5 class="modal-title" id="registeredModalLabel">會員註冊</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-6">
                            <div class="mb-3">
                                <label for="r_username" class="form-label" >帳號</label>
                                <input type="text" class="form-control is-invalid" id="r_username" name="r_username" placeholder="請輸入3~8個字">
                                <div class="invalid-feedback">不符合規定</div>
                                <div class="valid-feedback">符合規定</div>
                            </div>
                            <div class="mb-3 ">
                                <label for="r_password" class="form-label">密碼</label>
                                <div class="input-group">
                                    <input type="password" class="form-control is-invalid" id="r_password" name="r_password" placeholder="請輸入密碼">
                                    <div class="btn text-end" id="show_password"><i class="fa-solid fa-eye"></i></div>
                                    <div class="valid-feedback">符合規定</div>
                                    <div class="invalid-feedback">密碼至少8個字，至少包含一個數字與一組大小寫字母 EX:Aa123456</div>
                                </div>  
                            </div>
                            <div class="mb-3">
                                <label for="r_re_password" class="form-label">請再次輸入密碼</label>
                                <input type="password" class="form-control hiding is-invalid" id="r_re_password" name="r_re_password" placeholder="確認密碼">
                                <div class="valid-feedback">符合規定</div>
                                <div class="invalid-feedback">不符合規定</div>
                            </div>
                            <div class="mb-3">
                                <label for="r_datepicker" class="form-label">生日</label>
                                <input type="text" class="form-control hiding is-invalid" id="r_datepicker" name="r_datepicker" readonly>
                                <div class="valid-feedback">符合規定</div>
                                <div class="invalid-feedback">不符合規定</div>
                            </div>
                            <div class="mb-3">
                                <label for="r_email" class="form-label">email</label>
                                <input type="text" class="form-control hiding is-invalid" id="r_email" name="r_email" placeholder="EX:1234567@gmail.com">
                                <div class="valid-feedback">符合規定</div>
                                <div class="invalid-feedback">請輸入mail</div>
                            </div>
                        </div>
                        <div class="col-6">
                            <h3>會員守則</h3>
                            <p>帳號安全與保護：
                                會員應確保其帳號和密碼的安全，不得將帳號資訊提供給第三方。如果發現帳號被未經授權的使用，應立即通知網站管理員</p>
                            <p>真實性與準確性：
                                會員在註冊帳號及購物時應提供準確的個人信息，並確保所有提交的資料是真實和完整的。</p>
                            <p>遵守法律法規：
                                會員在使用網站服務過程中應遵守所有相關法律法規，不得從事任何非法或不正當的活動，如欺詐、盜竊或侵權行為。</p>
                            <p>責任與義務：
                                會員應對其在網站上進行的所有活動負責，包括但不限於購買商品、提交評論和參與論壇等，並承擔由此產生的責任。</p>
                            <p>支付與退款政策：
                                會員在進行購物時應遵守網站的支付政策，包括付款方式和退款規定。所有的交易均按照網站的支付和退款條款處理。</p>
                            <p>知識產權：
                                會員不得未經授權使用網站上的知識產權，包括商標、版權內容和其他受保護的材料。網站內容僅可用於個人、非商業用途。</p>
                            <p>修改與終止：
                                網站保留隨時修改會員條款的權利。會員應定期查閱條款變更。如會員違反條款，網站有權暫停或終止其帳號及服務。</p>
                            <div class="form-check">
                                <input type="checkbox" name="r_agree" id="r_agree" class="form-check-input is-invalid">
                                <label for="r_agree" class="form-check-label">同意</label>
                                <div class="valid-feedback"></div>
                                <div class="invalid-feedback"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                <button type="button" class="btn btn-primary" id="r_ok_btn">確認註冊</button>
                </div>
            </div>
        </div>
    </div>
    <!-- ************麵包屑*************** -->
    <section id="s03" class="mt-3">
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <nav aria-label="breadcrumb">
                        <ol class="breadcrumb" id="breadcrumb">
                            <li class="breadcrumb-item"><a href="index.html" style="color: black;">Home</a></li>
                            <li class="breadcrumb-item active" aria-current="page"><a href="product.html">產品總覽</a></li>
                        </ol>
                    </nav> 
                </div>
            </div>
        </div>   
    </section>
    <!-- ************s04*************** -->
    <section id="s06-1" class="my-3 wow animate__animated animate__fadeIn" data-wow-duration="1s" data-wow-delay="0" data-wow-iteration="1">
        <div class="container">
            <div class="product_responsive text-center" id="product_type">
                <div class="position-relative bg-navbar01">
                    <i class="fa-solid fa-couch fa-2x"></i>
                    <h4>沙發/椅子</h4>
                    <a href="#"class="stretched-link"></a>
                </div>
                <div class="position-relative bg-navbar01">
                    <i class="fa-solid fa-mug-saucer fa-2x"></i>
                    <p class="h4">辦公桌/辦公椅</p>
                    <a href="#"class="stretched-link"></a>
                </div>
                <div class="position-relative bg-navbar01">
                    <i class="fa-solid fa-bed fa-2x"></i>
                    <p class="h4">床組/寢具</p>
                    <a href="#"class="stretched-link"></a>
                </div>
                <div class="position-relative bg-navbar01">
                    <i class="fa-solid fa-shower fa-2x"></i>
                    <p class="h4">衛浴用品</p>
                    <a href="#"class="stretched-link"></a>
                </div>
                <div class="position-relative bg-navbar01">
                    <i class="fa-solid fa-kitchen-set fa-2x"></i>
                    <p class="h4">廚具/餐具</p>
                    <a href="#"class="stretched-link"></a>
                </div>
                <div class="position-relative bg-navbar01">
                    <i class="fa-regular fa-lightbulb fa-2x"></i>
                    <p class="h4">燈具/照明</p>
                    <a href="#"class="stretched-link"></a>
                </div>
                <div class="position-relative bg-navbar01">
                    <i class="fa-solid fa-rug fa-2x"></i>
                    <p class="h4">窗簾/地毯</p>
                    <a href="#"class="stretched-link"></a>
                </div>
            </div>
        </div>
    </section>
    <!-- ************s05*************** -->
     <section>
        <div class="container">
            <div class="row mt-3 h-100" id="product">
                <div class="col-lg-3 col-xl-3 my-3">
                    <div class="card">
                        <button style="background-image: url(image/furniture/product);height: 250px;" class="card-img-top bg-cover btn btn-light" alt="" ></button>
                        <div class="card-body text-center">
                            <a href="">
                                <div class="h4 fw-800">Arc休閒椅</div>
                                <div class="h5">$499</div>
                                <div class="h5"></div>
                            </a>
                            <button class="btn btn-dark" data-bs-toggle="modal" data-bs-target="#productModal" id="p_detail">查看詳情</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row mt-3">
                <nav aria-label="Page navigation example">
                    <ul class="pagination pagination justify-content-center " id="pagelist">
                      <li class="page-item disabled"><a class="page-link" href="#" tabindex="-1" aria-disabled="true">上一頁</a></li>
                      <li class="page-item"><a class="page-link" href="#">1</a></li>
                      <li class="page-item"><a class="page-link" href="#">2</a></li>
                      <li class="page-item"><a class="page-link" href="#">3</a></li>
                      <li class="page-item"><a class="page-link" href="#">下一頁</a></li>
                    </ul>
                  </nav>
            </div>
        </div>
     </section>

     <!-- productModal -->
     <div class="modal fade" id="productModal" tabindex="-1" aria-labelledby="ModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl ">
            <div class="modal-content">
                <div class="modal-header text-bg-success">
                <h5 class="modal-title" id="productModalLabel">產品資訊</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <input type="hidden" name="p_modal_id" id="p_modal_id" value="">
                        <div class="col-md-7 bg-cover d-flex align-items-center justify-content-center" id="p_modal_photo_lg">
                            <img src="image/furniture/chair01.jpg" class="w-100">
                        </div>
                        <div class="col-md-5 d-flex flex-column">
                          <div class="text-muted" id="p_modal_type">沙發/椅子</div>
                          <div class="h3 fw-900" id="p_modal_name">Arc休閒椅</div>
                          <h5 class="mt-2">產品介紹</h5>
                            <p id="p_modal_desc">123</p>
                          <div class="mb-3">
                            <label for="p_modal_stock" class="form-label" >庫存</label>
                            <input type="number" class="form-control" min="1" max="100" value="1" id="p_modal_stock" name="p_modal_stock" readonly>
                          </div>
                          <div class="mb-3">
                            <label for="p_modal_num" class="form-label" >數量</label>
                            <input type="number" class="form-control" min="1" max="50" value="1" id="p_modal_num" name="p_modal_num">
                          </div>
                          <div class="h4 mt-3" id="p_modal_price">價格:$499</div>
                          <div class="d-none" id="p_modal_d-none">
                            <div class="text-danger h3" id="p_modal_discount">優惠價</div>
                          </div>
                          <input type="hidden" name="p_modal_price_final" id="p_modal_price_final" value="">
                          <button class="btn btn-danger w-100 mt-auto" id="p_modal_shopping_cart">加入購物車</button>
                        </div>
                      </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <!-- ************s13*************** -->
    <section id="s13" class=" bg-op-colo1 align-content-center" style="height: 100px; border-bottom: 1px solid #dfd2c1;">
      <div class="container">
           <div class="row align-items-center ">
               <div class="col-6 ">
                   <a class="navbar-brand" href="index.html"><img src="image/furniture/Modernist_logo2.png" width="80px" alt=""></a>
               </div>
               <div class="col-6 d-flex justify-content-center">
                   <ul class="nav">
                       <li class="nav-item text-center">
                         <a class="nav-link active" aria-current="page" href="#">產品一覽</a>
                       </li>
                       <li class="nav-item">
                         <a class="nav-link" href="about.html">關於我們</a>
                       </li>
                       <li class="nav-item">
                         <a class="nav-link" href="#">精選推薦</a>
                       </li>
                     </ul>
               </div>
           </div>
      </div>
   </section>
   <!-- ************s13*************** -->
   <section id="s14" class=" bg-op-colo1 align-content-center" style="height: 100px;">
       <div class="container">
            <div class="row">
                <ul class="nav">
                   <li class="nav-item">
                       <a class="nav-link disabled" href="#" tabindex="-1" aria-disabled="true">© Modern Liner 2024. All Rights Reserved.</a>
                   </li>
               </ul>
            </div>
       </div>
    </section>
    <script src="js/bootstrap.bundle.min.js"></script>
    <script src="js/jquery-3.7.1.min.js"></script>
    <script src="js/sweetalert2@11.js"></script>
    <script type="text/javascript" src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
    <script type="text/javascript" src="slick/slick.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"></script>
    <script src="js/wow.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios@1.6.7/dist/axios.min.js"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script>
        var product_type=[];
        var newdata_all=[];
        var type_id;
        var flag_r_username = false;
        var flag_r_password = false;
        var flag_r_re_password = false;
        var flag_r_datepicker = false;
        var flag_r_email = false;
        var flag_r_agree = false;
        var user_id;
        //正規表達式
        //密碼
        const rules_pwd = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{8,}$/ ;
        //email
        const rules_email= /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
        $(function(){
             //wow初始化
            new WOW().init();

            //登入註冊
            //確認uid是否存在且合法
            if(getCookie("uid01")!=""){
                //將uid傳遞至後端api確認是否合法
                var dataJSON = {};
                    dataJSON["uid01"] = getCookie("uid01");
                    $.ajax({
                        type:"POST",
                        url:"API/member_login_check_uid_api.php",
                        data:JSON.stringify(dataJSON),
                        dataType:"json",
                        async:false,
                        success:showdata_check_uid,
                        error:function(){
                            alert("error-member_login_check_uid_api.php");
                        }
                    });
            }else{
                Swal.fire({
                    icon: "warning",
                    title: "尚未登入",
                    text: "請登入會員來使用購物車",
                    });
            }

            //監聽r_username
            $("#r_username").bind("input propertychange" , function(){
                if($(this).val().length>3 && $(this).val().length<10){
                    //符合前端規定
                    //傳遞至後段確認是否可使用
                    var dataJSON = {};
                    dataJSON["username"] = $("#r_username").val();
                    $.ajax({
                        type:"POST",
                        url:"API/member_register_checkuni_api.php",
                        data:JSON.stringify(dataJSON),
                        dataType:"json",
                        success:showdata_checkuni,
                        error:function(){
                            alert("error-member_register_checkuni_api.php");
                        }
                    });
                    
                    
                }else{
                    //不符合規定
                    $(this).removeClass("is-valid");
                    $("#r_username").next().html('<span>不符合規定</span>')
                    $(this).addClass("is-invalid");
                    flag_r_username = false;
                }
            });
            //監聽r_password
            $("#r_password").bind("input propertychange" , function(){
                if(rules_pwd.test($(this).val())){
                    $(this).removeClass("is-invalid");
                    $(this).addClass("is-valid");
                    flag_r_password = true;
                }else{
                    //不符合規定
                    $(this).removeClass("is-valid");
                    $(this).addClass("is-invalid");
                    flag_r_password = false;
                }
            });

            //監聽r_re_password
            $("#r_re_password").bind("input propertychange" , function(){
                if($(this).val()==$("#r_password").val()){
                    $(this).removeClass("is-invalid");
                    $(this).addClass("is-valid");
                    flag_r_re_password = true;
                }else{
                    //不符合規定
                    $(this).removeClass("is-valid");
                    $(this).addClass("is-invalid");
                    flag_r_re_password = false;
                }
            });
            
            //監聽r_datepicker
            $("#r_datepicker").bind("change" , function(){
                if($(this).val()!=" "){
                    $(this).removeClass("is-invalid");
                    $(this).addClass("is-valid");
                    flag_r_datepicker = true;
                }else{
                    //不符合規定
                    $(this).removeClass("is-valid");
                    $(this).addClass("is-invalid");
                    flag_r_datepicker = false;
                }
            });

             //監聽r_email
             $("#r_email").bind("input propertychange" , function(){
                if(rules_email.test($(this).val())){
                    $(this).removeClass("is-invalid");
                    $(this).addClass("is-valid");
                    flag_r_email = true;
                }else{
                    //不符合規定
                    $(this).removeClass("is-valid");
                    $(this).addClass("is-invalid");
                    flag_r_email = false;
                }
            });

             //監聽r_agree
             $("#r_agree").change(function(){
                if($(this).is(':checked')){
                    $(this).removeClass("is-invalid");
                    $(this).next().html('<span class="text-success">同意</span>');
                    $(this).addClass("is-valid");
                    flag_r_agree = true;
                }else{
                    //不符合規定
                    $(this).removeClass("is-valid");
                    $(this).next().html('<span class="text-danger">請同意會員守則</span>');
                    $(this).addClass("is-invalid");
                    flag_r_agree = false;
                }
            });

            //監聽註冊按鈕
            $("#r_ok_btn").click(function(){
                if(flag_r_username && flag_r_password && flag_r_re_password && flag_r_email && flag_r_datepicker && flag_r_agree){
                    //傳遞資料至後端api執行註冊行為
                    
                    var dataJSON = {};
                    dataJSON["username"] = $("#r_username").val();
                    dataJSON["password"] = $("#r_password").val();
                    dataJSON["birthday"] = $("#r_datepicker").val();
                    dataJSON["email"]    = $("#r_email").val();
                    $.ajax({
                        type:"POST",
                        url:"API/member_register_api.php",
                        data:JSON.stringify(dataJSON),
                        dataType:"json",
                        success:showdata_register,
                        error:function(){
                            alert("error-member_register_api.php");
                        }
                    });

                }else{
                    Swal.fire({
                    icon: "error",
                    title: "Oops...",
                    text: "欄位有誤請修正",
                    });
                }
            })
        
            /*登入*/
            //登入按鈕監聽
            $("#l_ok_btn").click(function(){
                if($("#l_username").val()!="" && $("#l_password").val()!="")
                {
                    //帳號密碼優輸入
                    //傳遞資料至後端api執行註冊行為
                    
                    var dataJSON = {};
                    dataJSON["username"] = $("#l_username").val();
                    dataJSON["password"] = $("#l_password").val();


                    $.ajax({
                        type:"POST",
                        url:"API/member_login_api.php",
                        data:JSON.stringify(dataJSON),
                        dataType:"json",
                        success:showdata_login,
                        error:function(){
                            alert("error-member_login.api.php");
                        }
                    });
                }else{
                    Swal.fire({
                    icon: "error",
                    title: "Oops...",
                    text: "帳號密碼有誤請修正",
                    });
                }
            });

            //登出按鈕監聽
            $("#s02_logout_button").click(function(){
                //將cookie設為空值
                setCookie("uid01","",7);
                //重整
                location.reload();
            });

            //監聽顯示密碼按紐
            $("#show_password").mousedown(function(){
                $(this).html('<i class="fa-solid fa-eye-slash"></i>');
                $("#r_password").attr('type', 'text');
            })
            $("#show_password").mouseup(function(){
                $(this).html('<i class="fa-solid fa-eye"></i>');
                $("#r_password").attr('type', 'password');
            })
            $("#show_password").mouseleave(function(){
                $(this).html('<i class="fa-solid fa-eye"></i>');
                $("#r_password").attr('type', 'password');
            })
            //end of 登入註冊 

            $.ajax({
                type:"GET",
                url:"API/product_read_api.php",
                dataType:"json",
                async:false,
                success:showdata_read,
                error:function(){
                    alert("error_member_read_api.php");
                }
            });

            $.ajax({
                type:"GET",
                url:"API/product_type_read_api.php",
                dataType:"json",
                async:false,
                success:showproduct_type_read,
                error:function(){
                    alert("error_member_read_api.php");
                }
            });

            $("#p_modal_shopping_cart").click(function(){
                    var dataJSON = {};
                    dataJSON["product_id"] = $("#p_modal_id").val();
                    dataJSON["product_name"] = $("#p_modal_name").html();
                    dataJSON["quantity"] = $("#p_modal_num").val();
                    dataJSON["price"] = $("#p_modal_price_final").val();
                    dataJSON["member_id"]=user_id;
                    console.log(JSON.stringify(dataJSON));
                    $.ajax({
                        type:"POST",
                        url:"API/cart_create_api.php",
                        data:JSON.stringify(dataJSON),
                        dataType:"json",
                        success:showdata_cart_add,
                        error:function(){
                            alert("error-member_update_api.php");
                        }
                    });
            });
            //vue
            let dataJSON2 = { member_id: user_id };
            const App={
                data(){
                    return{
                        items:[],
                        itemCount: 0,
                        userId: user_id,
                    }
                },
                methods: {
                    
                    fetchData(dataJSON) {
                    axios.post('API/cart_read_check_memberID_api.php',dataJSON)  // 替換為你的 API URL
                        .then(response => {
                        this.items = response.data;  // 將 API 返回的資料存入 items 陣列
                        this.itemCount = this.items.data.length;  // 計算資料筆數
                        })
                        .catch(error => {
                        console.error("資料獲取失敗:", error);
                        });
                    }
                },
                mounted() {
                    let dataJSON2 = { member_id: this.userId };  // 使用 Vue 的資料變數
                    this.fetchData(dataJSON2);  // 傳入資料進行請求
                },
            };
            //將App掛載在id為app的區塊裡，讓其可以使用data中的資料
            Vue.createApp(App).mount('#app');
            //end of vue


        });//end of function

        loadScript('js/app.js');
        function showdata_read(data){
            //分頁
            data.data.forEach(function(item,key){
                if(key % 10 ==0){
                    newdata_all.push([]);
                }
                var page = parseInt(key/12);
                newdata_all[page].push(item);
            });
            drawTable(0);

            //監聽產品類別按鈕
            $("#product_type").on('click','.slick-slide', function(event){
                type_id= $(this).data('id');
                type_name = $(this).data('name');
                $("#product").empty();

                //渲染麵包屑
                $("#breadcrumb").empty();
                var strBread='<li class="breadcrumb-item"><a href="index.html" style="color: black;">Home</a></li><li class="breadcrumb-item"><a href="product.html">產品總覽</a></li><li class="breadcrumb-item active" aria-current="page">'+type_name+'</li>';    
                $("#breadcrumb").append(strBread);
                $("#pagelist").empty()

                //渲染產品列表
                data.data.forEach(function(item){
                    if(type_id==item.Type_id)
                    {
                        if(item.Price_discount!=null)
                        {
                            strPrice='<div class="h5 text-black-50" style="text-decoration: line-through">$'+item.Price+'</div><div class="text-danger h5">優惠價:'+item.Price_discount+'</div>';
                        }else{
                            strPrice='<div class="h5">$'+item.Price+'</div>';
                        }
                        var strHtml ='<div class="col-lg-3 col-xl-3 my-3"><div class="card h-100"><button style="background-image: url(image/product/'+item.Image_url+');height: 250px;" class="card-img-top bg-cover btn btn-light" alt=""></button><div class="card-body text-center d-flex flex-column"><a href=""><div class="h4 fw-800">'+item.Product_name+'</div>'+strPrice+'<div class="h5"></div></a><button class="btn btn-dark mt-auto" data-id='+item.ID+' data-price='+item.Price+' data-name='+item.Product_name+' data-image='+item.Image_url+' data-description='+item.Description+' data-type_id='+item.Type_id+' data-price_discount='+item.Price_discount+' data-stock='+item.Stock+' data-product_type='+item.Product_type+' data-bs-toggle="modal" data-bs-target="#productModal" id="p_detail">查看詳情</button>';
                        $("#product").append(strHtml);
                    }
                });//end forEach

                //監聽詳情按鈕
                $("#product #p_detail").click(function(){
                    $("#p_modal_id").val($(this).data("id"));
                    $("#p_modal_photo_lg").html('<img src="image/product/' + $(this).data("image") + '"  class="w-75" alt="" />');
                    $("#p_modal_type").html($(this).data("product_type"));
                    $("#p_modal_name").html($(this).data("name"));
                    $("#p_modal_desc").html($(this).data("description"));
                    $("#p_modal_stock").val($(this).data("stock"));
                    var p_price = $(this).data("price");
                    var p_discount=$(this).data("price_discount");
                    $("#p_modal_price").html('價格:$'+p_price);
                    if($(this).data("price_discount")!=null)
                    {
                        $("#p_modal_price").addClass("text-black-50");
                        $("#p_modal_price").css("text-decoration","line-through");
                        $("#p_modal_d-none").removeClass("d-none");
                        $("#p_modal_discount").html("優惠價:$"+$(this).data("price_discount"));
                        $("#p_modal_price_final").val($(this).data("price_discount"));

                    }else{
                        $("#p_modal_d-none").addClass("d-none");
                        $("#p_modal_price").removeClass("text-black-50");
                        $("#p_modal_price").removeAttr("style");
                        $("#p_modal_price_final").val($(this).data("price"));
                    }
                    
                    //如果圖片無法讀取
                    $("img").on("error", function() {
                        if ($(this).attr("src") !== "../../../image/product//No_image_available.svg") {
                            $(this).attr("src", "../../../image/product//No_image_available.svg");
                        }
                    });
                 });//end of #product #p_detail click

            });//end of product_type click
        };//end of showdata_read()
        function drawTable(page)
        {
            $("#product").empty()
            newdata_all[page].forEach(function(item){
                if(item.Price_discount!=null)
                {
                    strPrice='<div class="h5 text-black-50" style="text-decoration: line-through">$'+item.Price+'</div><div class="text-danger h5">優惠價:$'+item.Price_discount+'</div>';
                }else{
                    strPrice='<div class="h5">$'+item.Price+'</div>';
                }
                
                var strHtml ='<div class="col-lg-3 col-xl-3 my-3"><div class="card h-100"><button style="background-image: url(image/product/'+item.Image_url+');height: 250px;" class="card-img-top bg-cover btn btn-light" alt=""></button><div class="card-body d-flex flex-column text-center"><a href=""><div class="h4 fw-800">'+item.Product_name+'</div>'+strPrice+'<div class="h5"></div></a><button class="btn btn-dark mt-auto" data-id='+item.ID+' data-price='+item.Price+' data-name='+item.Product_name+' data-image='+item.Image_url+' data-description='+item.Description+' data-type_id='+item.Type_id+' data-price_discount='+item.Price_discount+' data-stock='+item.Stock+' data-product_type='+item.Product_type+' data-bs-toggle="modal" data-bs-target="#productModal" id="p_detail">查看詳情</button></div></div></div>';
                $("#product").append(strHtml);
            });
            //上一頁按鈕
            $("#pagelist").empty();
            var previousPage = page-1;
            if (previousPage < 0) {
                previousPage = 0; // 防止頁數超出範圍
            };
    
             $("#pagelist").append('<li class="page-item ' + (page == 0 ? 'disabled' : '') + '" onclick="drawTable(' + previousPage + ')"><a class="page-link" href="#">上一頁</a></li>');
    
            //產生頁碼
            for(var i=0;i<newdata_all.length;i++){
                var thisPage = i+1;
                var anotherPage = thisPage-1;
                var strHTML;
                if(thisPage==page+1){
                    strHTML='<li class="page-item active" onclick = "drawTable('+anotherPage+')"><a class="page-link" href="#">'+thisPage+'</a></li>';
                }else{
                    strHTML='<li class="page-item" onclick = "drawTable('+anotherPage+')"><a class="page-link" href="#">'+thisPage+'</a></li>';
                }
                $("#pagelist").append(strHTML);
            };
    
            //下一頁按鈕
            var nextPage = page+1;
            if (nextPage >= newdata_all.length) {
                nextPage =  newdata_all.length-1; // 防止頁數超出範圍
            };
            $("#pagelist").append('<li class="page-item ' + (page == (newdata_all.length-1) ? 'disabled' : '') + '" onclick="drawTable(' + nextPage + ')"><a class="page-link" href="#">下一頁</a></li>');

            //監聽update按鈕
            $("#product #p_detail").click(function(){
                $("#p_modal_id").val($(this).data("id"));
                $("#p_modal_photo_lg").html('<img src="image/product/' + $(this).data("image") + '"  class="w-75" alt="" />');
                $("#p_modal_type").html($(this).data("product_type"));
                $("#p_modal_name").html($(this).data("name"));
                $("#p_modal_desc").html($(this).data("description"));
                $("#p_modal_stock").val($(this).data("stock"));
                var p_price = $(this).data("price");
                var p_discount=$(this).data("price_discount");
                $("#p_modal_price").html('價格:$'+p_price);
                if($(this).data("price_discount")!=null)
                {
                    $("#p_modal_price").addClass("text-black-50");
                    $("#p_modal_price").css("text-decoration","line-through");
                    $("#p_modal_d-none").removeClass("d-none");
                    $("#p_modal_discount").html("優惠價:$"+$(this).data("price_discount"));
                    $("#p_modal_price_final").val($(this).data("price_discount"));

                }else{
                    $("#p_modal_d-none").addClass("d-none");
                    $("#p_modal_price").removeClass("text-black-50");
                    $("#p_modal_price").removeAttr("style");
                    $("#p_modal_price_final").val($(this).data("price"));
                }
                
                
                // $("#p_modal_price").html((p_discount != null ? '優惠價:'+p_discount : '價格:'+p_price));
                //如果圖片無法讀取
                $("img").on("error", function() {
                    if ($(this).attr("src") !== "../../../image/product//No_image_available.svg") {
                        $(this).attr("src", "../../../image/product//No_image_available.svg");
                    }
                });
            });// end of 監聽update按鈕
        }//end of drawTable()

        function showproduct_type_read(data){
            $("#product_type").empty();
            data.data.forEach(function(item){
                var strHtml='<div class="position-relative bg-navbar01" data-id="'+item.Type_id+'" data-name="'+item.Product_type+'"><i class="'+item.Icon+'"></i><h4>'+item.Product_type+'</h4><a href="#"class="stretched-link"></a></div>';
                $("#product_type").append(strHtml);
            });
            $(".product_responsive").slick({
            dots: false,
            infinite: false,
            speed: 300,
            slidesToShow: 6,
            slidesToScroll: 1,
            prevArrow:'<button type="button" class="slick-prev"><i class="fas fa-chevron-left"></i></button>',
            nextArrow:'<button type="button" class="slick-next"><i class="fas fa-chevron-right"></i></button>',
            responsive: [
                {
                breakpoint: 1024,
                settings: {
                    slidesToShow: 1,
                    slidesToScroll: 1,
                    infinite: true,
                    dots: true
                }
                },
            ]
            }); 
        };//end of showproduct_type_read()

        function showdata_checkuni(data) {
            if (data.state) {
                $("#r_username").removeClass("is-invalid");
                $("#r_username").addClass("is-valid");
                flag_r_username = true;
            } else {
                $("#r_username").removeClass("is-valid");
                $("#r_username").next().html('<span>'+data.message+'</span>')
                $("#r_username").addClass("is-invalid");
                
                flag_r_username = false;
            }
        }// end of showdata_checkuni()

        function showdata_register(data){
            if(data.state){
                Swal.fire({
                title: "Good job!",
                text: data.message,
                icon: "success",
                timer: 1500,
                }).then((result) => {
                if (result.isConfirmed) {
                    // 重整頁面
                    location.reload();
                }
            });
                
            }else{
                Swal.fire({
                title: "OOPS",
                text: data.message,
                icon: "error"
                });
            }
        }//end of showdata_register()
        function showdata_login(data){
            if(data.state){
                if(data.data.State == "1"){
                    //帳號啟用
                    Swal.fire({
                    title: "Good job!",
                    text: data.message,
                    icon: "success"
                    }).then((result) => {
                        if (result.isConfirmed) {
                            // 重整頁面
                            location.reload();
                        }
                    });
                    //隱藏modal
                    $("#loginModal").modal("hide");
                    //顯示登入帳號
                    if(data.data.Level=="0"){
                        level_text="一般會員";
                        strHTML="您好"+data.data.Username+"會員等級:"+level_text;
                    }else if(data.data.Level=="100"){
                        level_text="VIP1";
                        strHTML="您好"+data.data.Username+ " 會員等級:"+'<i class="fa-solid fa-crown me-1 ms-1 text-colorGreatYellow"></i>'+level_text;
                    }else if(data.data.Level=="200"){
                        level_text="VIP2";
                        strHTML="您好"+data.data.Username+ " 會員等級:"+'<i class="fa-solid fa-crown me-1 ms-1 text-colorGreatYellow"></i>'+level_text;
                    }else if(data.data.Level=="300"){
                        level_text="VIP3";
                        strHTML="您好"+data.data.Username+ " 會員等級:"+'<i class="fa-solid fa-crown me-1 ms-1 text-colorGreatYellow"></i>'+level_text;
                    }else{
                        level_text="管理員";
                        strHTML="您好"+'<i class="fa-solid fa-crown me-1 ms-1 text-colorGreatYellow"></i>'+level_text;
                    }
                    $("#login_username_message").html(strHTML);
                    //隱藏登入與註冊按鈕
                    $("#s02_login_button").addClass("d-none");
                    $("#s02_register_button").addClass("d-none");
                    //顯示登出按鈕
                    $("#s02_logout_button").removeClass("d-none");
                    $("#s02_login_icon").removeClass("d-none");
                    if(data.data.Level>="200" && data.data.Level<"800"){
                        //顯示優惠
                        //顯示vip下拉選單
                        $(".dropdown-item-vip").removeClass("disabled");
                    }else if(data.data.Level>="800"){
                        //管理員
                        //顯示vip下拉選單
                        $(".dropdown-item-vip").removeClass("disabled");
                        //manager only
                        $("#s01_manager_only").removeClass("d-none");
                    }
                }else{
                    //帳號為停用狀態
                    Swal.fire({
                    title: "您已被停權!",
                    text: "帳號為停用狀態",
                    icon: "error",
                    footer: '<a href="#">您的帳號已被停權，若有任何問題請聯繫我們</a>'
                    });
                    //隱藏modal
                    $("#loginModal").modal("hide");
                    //顯示登入帳號
                    $("#login_username_message").text(data.data.Username+"  您已被停權");
                    $("#login_username_message").addClass("text-danger");
                    //隱藏登入與註冊按鈕
                    $("#s02_login_button").addClass("d-none");
                    $("#s02_register_button").addClass("d-none");
                    //顯示登出按鈕
                    $("#s02_logout_button").removeClass("d-none");
                    $("#s02_login_icon").removeClass("d-none");
                    $("#s02_login_icon_2").removeClass("fa-user");
                    $("#s02_login_icon_2").addClass("fa-skull-crossbones");
                    
                }
                
                
                //將uid01寫入cookie
                //setCookie("aplication_name",data_name,days)
                setCookie("uid01",data.data.Uid01,7)
                

            }else{
                
                Swal.fire({
                title: "OOPS",
                text: data.message,
                icon: "error"
                });
            }
        }//end of showdata_login()
        
        //利用cookie登入
        function showdata_check_uid(data){
                //顯示登入帳號
                user_id=data.data.ID;
                if(data.state){
                    if(data.data.State == "1"){
                        //帳號啟用
                        if(data.data.Level=="0"){
                            level_text="一般會員";
                            strHTML="您好"+data.data.Username+"會員等級:"+level_text;
                        }else if(data.data.Level=="100"){
                            level_text="VIP1";
                            strHTML="您好"+data.data.Username+ " 會員等級:"+'<i class="fa-solid fa-crown me-1 ms-1 text-colorGreatYellow"></i>'+level_text;
                        }else if(data.data.Level=="200"){
                            level_text="VIP2";
                            strHTML="您好"+data.data.Username+ " 會員等級:"+'<i class="fa-solid fa-crown me-1 ms-1 text-colorGreatYellow"></i>'+level_text;
                        }else if(data.data.Level=="300"){
                            level_text="VIP3";
                            strHTML="您好"+data.data.Username+ " 會員等級:"+'<i class="fa-solid fa-crown me-1 ms-1 text-colorGreatYellow"></i>'+level_text;
                        }else{
                            level_text="管理員";
                            strHTML="您好"+'<i class="fa-solid fa-crown me-1 ms-1 text-colorGreatYellow"></i>'+level_text;
                        }
                        $("#login_username_message").html(strHTML);
                        // $("#login_username_message").text(data.data.Username+level_text);
                        //隱藏登入與註冊按鈕
                        $("#s02_login_button").addClass("d-none");
                        $("#s02_register_button").addClass("d-none");
                        //顯示登出按鈕
                        $("#s02_logout_button").removeClass("d-none");
                        $("#s02_login_icon").removeClass("d-none");
                        
                        if(data.data.Level>="100" && data.data.Level<"800"){
                        //顯示優惠
                            $(".dropdown-item-vip").removeClass("disabled");
                        }else if(data.data.Level>="800"){
                            $(".dropdown-item-vip").removeClass("disabled");
                            //manager only
                            $("#s01_manager_only").removeClass("d-none");
                        }
                    }else{
                        //帳號為停用狀態
                        Swal.fire({
                        title: "您已被停權!",
                        text: "帳號為停用狀態!",
                        icon: "error",
                        footer: '<a href="#">您的帳號已被停權，若有任何疑慮請聯繫我們</a>'
                        });
                        //隱藏modal
                        $("#loginModal").modal("hide");
                        //顯示登入帳號
                        $("#login_username_message").text(data.data.Username+"  您已被停權");
                        $("#login_username_message").addClass("text-danger");
                        //隱藏登入與註冊按鈕
                        $("#s02_login_button").addClass("d-none");
                        $("#s02_register_button").addClass("d-none");
                        //顯示登出按鈕
                        $("#s02_logout_button").removeClass("d-none");
                        $("#s02_login_icon").removeClass("d-none");
                        $("#s02_login_icon_2").removeClass("fa-user");
                        $("#s02_login_icon_2").addClass("fa-skull-crossbones");
                    }
                    
                }
        }//end of showdata_check_uid()

        function showdata_cart_add(data){
            if(data.state){
                Swal.fire({
                    title: "Good job!",
                    text: data.message,
                    icon: "success"
                    });
            }else{
                Swal.fire({
                title: "OOPS",
                text: data.message,
                icon: "error"
                });
            }
        }//end of showdata_cart_add()
        
        //**************cookie function from w3*****************
        function setCookie(cname, cvalue, exdays) {
            const d = new Date();
            d.setTime(d.getTime() + (exdays*24*60*60*1000));
            let expires = "expires="+ d.toUTCString();
            document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
            }

        function getCookie(cname) {
            let name = cname + "=";
            let decodedCookie = decodeURIComponent(document.cookie);
            let ca = decodedCookie.split(';');
            for(let i = 0; i <ca.length; i++) {
                let c = ca[i];
                while (c.charAt(0) == ' ') {
                c = c.substring(1);
                }
                if (c.indexOf(name) == 0) {
                return c.substring(name.length, c.length);
                }
            }
            return "";
            }
    </script>
        <!-- datepicker -->
    <script>
        $(document).ready(function() {
            $('#r_datepicker').datepicker({
                format :'yyyy-mm-dd'
            });
        });
    </script>
</body>
</html>